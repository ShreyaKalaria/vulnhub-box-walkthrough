# Basic Pentesting: 2
[VulnHub link](https://www.vulnhub.com/entry/basic-pentesting-2,241/)  
By Josiah Pierce  

* After the victim VM has been booted up, we are greeted with a login page that takes in the input of a username and a password.
![](/screenshots/basic-pentesting-2/loginInitial.jpg)
* We attempt a login with several basic credentials such as `admin:admin`, but to no avail expectedly.
* Run `nmap 10.0.2.*`, where we find 5 live hosts:
![](/screenshots/basic-pentesting-2/nmapScan.jpg)
* After eliminating our own IP address and our router gateway IP address, the vulnerable VM's IP address should be `10.0.2.19`.
* Run `nmap -p- -A 10.0.2.19`, which means to scan all ports from 1 to 65535 (0 is excluded), and to enable OS detection, version detection (for the available services), script scanning, and traceroute:
![](/screenshots/basic-pentesting-2/scanAllPortsandServiceVersions.jpg)
* The host is running 6 services, where all of the listed ports below are open:
1. SSH at port 22
2. Apache httpd at port 80
3. Samba smbd at ports 139 and 445
4. Apache Jserv at port 8009
5. Apache Tomcat at port 8080
* *Digression: This machine has almost as many services as `stapler`, the first mammoth that I encountered*.
* To make things more systematic (and to see if such an order works), I will start off from the top of the list, i.e. with SSH.

# SSH at Port 22
* I tried to connect with `ssh 10.0.2.19` and common passwords like `password`, but there was nothing noteworthy.
* The version running is `OpenSSH 7.2p2 Ubuntu 4ubuntu2.4`. I found a [username enumeration](https://www.exploit-db.com/exploits/40136) for this version - will try this out if we are stuck later on.
* Moving onto Apache httpd at port 80 next...
* **Update after finishing enumerating Apache httpd and Samba SMBD**: We found out at port 80 that user `J`'s password is very likely to be cracked easier, and enumerating Samba told us what `J` and `K` meant.
* Putting two and two together, I ran `hydra` with `rockyou.txt` against both `jan` and `kay`, putting them in usernames.txt, and using the `rockyou.txt` wordlist: `hydra -L usernames.txt -P /usr/share/wordlists/rockyou.txt 10.0.2.19 ssh`.
* True enough, we got a set of credentials: `jan:armando`. I stopped the process after that because I was not expecting to crack `kay`'s password.
![](/screenshots/basic-pentesting-2/hydraJanCredentials.jpg)
* Logging in as as `jan`, there was nothing interesting found in his home directory:
![](/screenshots/basic-pentesting-2/sshJanLogin.jpg)
* So we head to `kay`'s home directory, and find a couple of files relating to his SSH keys:
![](/screenshots/basic-pentesting-2/sshKayDirectory.jpg)
* `id_rsa` contained the RSA private key, while `authorized_keys` and `id_rsa.pub` contained the same contents. The latter 2 files had this line at the end of the file: "I don't have to type a long password anymore!".
* I tried to log in with `ssh -i id_rsa kay@localhost`, but I was prompted for the passphrase for key 'id_rsa'.
* I ran `sudo -l` to see what programs we could run as `jan`, but was told that this user could not run sudo on basic2.
* Tried to run `linux-exploit-suggester`, but I was unable to use `chmod` to give executable permissions to it.
* I was able to run `linuxprivchecker`, which gave me an entire list of results as expected.
* I decided to next run `find / -user root -perm -4000 -print 2>/dev/null` first to see if there were any SetUID binaries that we could exploit - which there is! We will be using `vim.basic`.
![](/screenshots/basic-pentesting-2/setUIDBinaries.jpg)
* I removed the password for user `root` using `vim.basic /etc/passwd`, and ran `sudo su`. We are `root`!
* Note: We have to save the file with `:x!` and press `Enter` after our changes our made, because the read-only option is set.
* Head to `/root` directory, and open `flag.txt`. Hurray - we are done!
![](/screenshots/basic-pentesting-2/flag.jpg)
* Alternatively, use the same method in `dc-4` where we inserted `fakeroot::0:0:::/bin/bash` into `/etc/passwd`.
* Failed attempt: I tried to run `vim.basic`, then type `:set shell=/bin/sh` and `:shell`. However, the shell spawned was still that of a low privilege one. Hmm.

# Apache httpd at Port 80
* Visiting `http://10.0.2.19/` gives us a clean page that says that the page is undergoing maintenance, and that we should check back later. Opening up the page source tells us something extra, that we should "check the dev note section if we need to know what to work on". This message seems to be meant for the site developers.
![](/screenshots/basic-pentesting-2/siteInitialLoad.jpg)
* I tried `/dev`. `/devnote`, `/readme.html` and `/robots.txt`, but they all returned a Not Found message.
* Running `nikto -h 10.0.2.19` gives us the link to the "dev note section" - turns out that it is `/development` (silly me!).
![](/screenshots/basic-pentesting-2/niktoScan.jpg)
* Visiting `/development` shows us 2 files - `dev.txt` and `j.txt`:
![](/screenshots/basic-pentesting-2/developmentDirectoryFiles.jpg)
* `dev.txt` shows a series of logs detailing what had been configured or set up. Version 2.5.12 appears to have been changed because our earlier nmap version scan did not show that any of the service had such a version number.
* `j.txt` has something juicy - if we can get the password hash of user `J`, it seems like we would be able to crack it easily.
* These 2 files also tells us that there are (so far) 2 developers - `J` and `K`.
* Next, I ran `gobuster dir -u http://10.0.2.19/ -w /usr/share/wordlists/dirb/common.txt` to see if there were any directories or files besides development that we could have a go at - but we got nothing new (only 2 pages that we could access):
![](/screenshots/basic-pentesting-2/gobusterPort80Scan.jpg)
* *To explore: The gobuster command that we used in stapler seemed to have a different syntax from the one here.*
* That is about here for now I suppose. Moving onto Samba smbd...

# Samba SMBD at Port 139 and 445
* Running `enum4linux 10.0.2.19` tells us the username of the 2 developers whom we have gotten to know earlier - `jan` and `kay`.
![](/screenshots/basic-pentesting-2/sambaUsernameEnum.jpg)
* Another noteworthy discovery from the enumeration is that we found a sharename `Anonymous`, where `smbmap -H 10.0.2.19` tells us that the share is read-only.
![](/screenshots/basic-pentesting-2/shareEnum.jpg)
* Logging in as `Anonymous` leads us to only 1 file, `staff.txt`. The message is directed at all staff to "not upload non-work-related items to this share". No new or noteworthy information is discovered here (since we had already known their usernames in the earlier username enumeration.
![](/screenshots/basic-pentesting-2/staffTxt.jpg)
* Failed attempt: We previously used `use exploit/linux/samba/is_known_pipename` in `stapler`, but that does not work here because we do not have a writeable folder though we have an accessible share.
* Moving onto the last 2 services...

# Apache Jserv at Port 8009
* I could not load any page with `http://10.0.2.19:8009/` or the `https` version, so I ran a Google search on what the `ajp13` protocol is. Turns out that it stands for Apache JServ Protocol (AJP), it is packet-oriented and apparently exists for better performance. This [StackOverflow article](https://stackoverflow.com/questions/21757694/what-is-ajp-protocol-used-for) gave me a decent understanding.
* This service is related to Apache Tomcat, so I will be moving onto it first, since it is the next (and last) service for us to enumerate.

# Apache Tomcat at Port 8080
* Loading `http://10.0.2.19:8080/` shows us a page which apparently appears when Apache Tomcat had been successfully installed:
![](/screenshots/basic-pentesting-2/apacheTomcatInstalled.jpg)
* Clicking into `Server Status`, `Manager App` or `Host Manager` requires us to enter a set of credentials:
![](/screenshots/basic-pentesting-2/tomcatLoginBox.jpg)
* Running `nikto -h 10.0.2.19:8080` gives us:
![](/screenshots/basic-pentesting-2/niktoScanTomcat.jpg)
* Running `gobuster dir -u http://10.0.2.19:8080 -w /usr/share/wordlists/dirb/common.txt` yields nothing new:
![](/screenshots/basic-pentesting-2/gobusterPort8080Scan.jpg)
* To-be-continued...

# Concluding Remarks
This is the first challenge that I solved without referring to any walkthroughs or write-ups by others, and this definitely gave me a huge confidence boost!